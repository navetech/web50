{% extends "layout.html" %}

{% block title %}
    User Messages
{% endblock %}

{% block main %}
    <ul class="list-group ln-group-width-auto">
        <li class="list-group-item ln-container01 ln-h03">
            {% if user.name == session.user.name %}
                <span class="ln-highlight">{{ user.name }}</span>
            {% else %}
                <a class="ln-highlight" href="{{ url_for('message_to_user', user_name=user['name']) }}">{{ user.name }}</a>
            {% endif %}
            registered on
            <span class="ln-highlight">{{ user.timestamp }}</span>,
            logged on
            <span class="ln-highlight">{{ user.login.timestamp }}</span>
        </li>
    </ul>

    <div class="ln-group-divider"></div>

    {% if user.name != session.user.name %}
        <ul class="list-group pt-4 ln-group-width-auto">
            <li class="list-group-item ln-container01">
                <a class="btn btn-dark" role="button" href="{{ url_for('message_to_user', user_name=user['name']) }}">Send a Message</a>
            </li>
        </ul>
    {% endif %}

    {% for message in messages %}
        <ul class="list-group pt-4">
            <li class="list-group-item ln-container01">
                from
                <span class="ln-highlight">{{ message.sender.name }}</span>
                {% if message.receiver.user %}
                    to
                    <span class="ln-highlight">{{ message.receiver.user.name }}</span>
                {% elif message.receiver.channel %}
                    to channel
                    <span class="ln-highlight">{{ message.receiver.channel.name }}</span>
                {% endif %}
                on
                <span class="ln-highlight">{{ message.timestamp }}</span>
                {% if message.sender.name == session.user.name %}
                    <a class="btn btn-dark" role="button" href="{{ url_for('message_delete', message_id=message['id']) }}">Delete</a>
                {% endif %}
            </li>

            <li class="list-group-item ln-container01">
                <textarea readonly class="message-text-out" rows= {{ messages_config.texts.rows_number }}>{{ message.text }}</textarea>
            </li>
        </ul>
        {% else %}
        <ul class="list-group pt-4">
            <li class="list-group-item ln-container01">No messages</li>
        </ul>
        {% endfor %}
{% endblock %}
